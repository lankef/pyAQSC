# Evaluates coefficient of diff(B_psi_dummy,phi,2) 
from math import floor, ceil
from math_utilities import *
import chiphifunc
def eval_coef_dphi_2(n, B_psi_coef_cp, B_theta_coef_cp, 
    Delta_coef_cp, p_perp_coef_cp,
    X_coef_cp, Y_coef_cp, Z_coef_cp, 
    iota_coef, dl_p,
    B_denom_coef_c, B_alpha_coef, 
    kap_p, tau_p):    
    (-(((2-2*Delta_coef_cp[0])*X_coef_cp[1]*Y_coef_cp[1]*diff(Y_coef_cp[1],'chi',2)+(2-2*Delta_coef_cp[0])*X_coef_cp[1]*(diff(Y_coef_cp[1],'chi',1))**2+(2*Delta_coef_cp[0]-2)*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+(2*Delta_coef_cp[0]-2)*Y_coef_cp[1]**2*diff(X_coef_cp[1],'chi',2))*dl_p*kap_p*tau_p+((2-2*Delta_coef_cp[0])*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',2)+(2-2*Delta_coef_cp[0])*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+(2*Delta_coef_cp[0]-2)*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+(2*Delta_coef_cp[0]-2)*Y_coef_cp[1]*(diff(X_coef_cp[1],'chi',1))**2)*diff(kap_p,'phi',1)+(B_alpha_coef[0]-B_alpha_coef[0]*Delta_coef_cp[0])*diff(B_denom_coef_c[1],'chi',1)*dl_p*kap_p**2+(((3-3*Delta_coef_cp[0])*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+(3-3*Delta_coef_cp[0])*(diff(X_coef_cp[1],'chi',1))**2)*diff(Y_coef_cp[1],'phi',1)+(3*Delta_coef_cp[0]-3)*iota_coef[0]*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',3)+(3*Delta_coef_cp[0]-3)*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',2,'phi',1)+((3*Delta_coef_cp[0]-3)*X_coef_cp[1]*diff(X_coef_cp[1],'phi',1)+(6*Delta_coef_cp[0]-6)*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)+X_coef_cp[1]**2*diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'chi',2)+(3*Delta_coef_cp[0]-3)*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',1)+((3*Delta_coef_cp[0]-3)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+(3-3*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1)+(3-3*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+(3-3*Delta_coef_cp[0])*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)+((3-3*Delta_coef_cp[0])*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)-X_coef_cp[1]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',2)+(3-3*Delta_coef_cp[0])*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1)-Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',1))**2)*kap_p)/(B_alpha_coef[0]*dl_p*kap_p**2*n**2-B_alpha_coef[0]*dl_p*kap_p**2*n))+(((-(2*Delta_coef_cp[0]-2)*X_coef_cp[1]*(diff(Y_coef_cp[1],'chi',1))**2)-(2-2*Delta_coef_cp[0])*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1))*dl_p*kap_p*n*tau_p)/(B_alpha_coef[0]*dl_p*kap_p**2*n**2-B_alpha_coef[0]*dl_p*kap_p**2*n)+(((-((2*Delta_coef_cp[0]-2)*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+(2-2*Delta_coef_cp[0])*Y_coef_cp[1]*(diff(X_coef_cp[1],'chi',1))**2)*diff(kap_p,'phi',1))-(B_alpha_coef[0]*Delta_coef_cp[0]-B_alpha_coef[0])*diff(B_denom_coef_c[1],'chi',1)*dl_p*kap_p**2-((3*Delta_coef_cp[0]-3)*(diff(X_coef_cp[1],'chi',1))**2*diff(Y_coef_cp[1],'phi',1)+(3-3*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',2)+(3-3*Delta_coef_cp[0])*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',1)+((3-3*Delta_coef_cp[0])*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)-X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1)+(3*Delta_coef_cp[0]-3)*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2)+(3*Delta_coef_cp[0]-3)*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1)+Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',1))**2)*kap_p)*n)/(B_alpha_coef[0]*dl_p*kap_p**2*n**2-B_alpha_coef[0]*dl_p*kap_p**2*n)
    return(out)
