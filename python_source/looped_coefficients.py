# Stores looped equation constants.

# ChiPhiFunc and ChiPhiEpsFunc
from chiphifunc import *
from chiphiepsfunc import *
from math_utilities import *
import numpy as np

# The looped equation coefficients are very long and will be costly to calculate.
# So, we do the bulk of the calculation once when initializing/loading each equilibrium,
# and only caluclate the n dependence during each iteration steps.
def calculate_raw(B_psi_coef_cp, B_theta_coef_cp, \
    Delta_coef_cp, p_perp_coef_cp,\
    X_coef_cp, Y_coef_cp, Z_coef_cp, \
    iota_coef, dl_p,\
    B_denom_coef_c, B_alpha_coef, \
    kap_p, tau_p):

    # Coefficient of Y -------------------------------------------------------------
    # No dchi component should be ignored because ALL Y COMPONENTS contain the constant
    # (chi-indep) component
    Coef_Y_raw = (
        2*(Delta_coef_cp[0]-1)*(diff(X_coef_cp[1],'chi',1))*dl_p*(diff(tau_p,'phi',1))
        +(
            2*(Delta_coef_cp[0]-1)*iota_coef[0]*(diff(X_coef_cp[1],'chi',2))
            +2*(Delta_coef_cp[0]-1)*(diff(X_coef_cp[1],'chi',1,'phi',1))
            +2*(diff(Delta_coef_cp[0],'phi',1))*(diff(X_coef_cp[1],'chi',1))
        )*dl_p*tau_p
        +(1-Delta_coef_cp[0])*iota_coef[0]**2*(diff(Y_coef_cp[1],'chi',3))
        +2*(1-Delta_coef_cp[0])*iota_coef[0]*(diff(Y_coef_cp[1],'chi',2,'phi',1))
        -iota_coef[0]*(diff(Delta_coef_cp[0],'phi',1))*(diff(Y_coef_cp[1],'chi',2))
        +(1-Delta_coef_cp[0])*(diff(Y_coef_cp[1],'chi',1,'phi',2))
        -(diff(Delta_coef_cp[0],'phi',1))*(diff(Y_coef_cp[1],'chi',1,'phi',1))
    )/B_alpha_coef[0]

    Coef_dchi_Y_raw_a = -2*(1-Delta_coef_cp[0])*iota_coef[0]*(diff(X_coef_cp[1],'chi',1))*dl_p*tau_p
    Coef_dchi_Y_raw_b = -(
        (2*Delta_coef_cp[0]-2)*X_coef_cp[1]*dl_p*(diff(tau_p,'phi',1))
        +(
            (2*Delta_coef_cp[0]-2)*(diff(X_coef_cp[1],'phi',1))
            +2*X_coef_cp[1]*(diff(Delta_coef_cp[0],'phi',1))
        )*dl_p*tau_p
        +(1-Delta_coef_cp[0])*(diff(Y_coef_cp[1],'phi',2))
        -(diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'phi',1)
        +(1-Delta_coef_cp[0])*iota_coef[0]**2*(diff(Y_coef_cp[1],'chi',2))
        +(2-2*Delta_coef_cp[0])*iota_coef[0]*(diff(Y_coef_cp[1],'chi',1,'phi',1))
    )/B_alpha_coef[0]
    Coef_dchi_Y_raw_c = iota_coef[0]*(diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'chi',1)/B_alpha_coef[0]


    Coef_dphi_Y_raw = (
        2*(Delta_coef_cp[0]-1)*(diff(X_coef_cp[1],'chi',1))*dl_p*tau_p
        +(diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'chi',1)
    )/B_alpha_coef[0]

    Coef_dchi_dphi_Y_raw_a = -(2-2*Delta_coef_cp[0])*iota_coef[0]*diff(Y_coef_cp[1],'chi',1)/B_alpha_coef[0]
    Coef_dchi_dphi_Y_raw_b = -(
        (2*Delta_coef_cp[0]-2)*X_coef_cp[1]*dl_p*tau_p
        +Y_coef_cp[1]*(diff(Delta_coef_cp[0],'phi',1))
    )/B_alpha_coef[0]

    Coef_dphi_dphi_Y_raw = (
        (Delta_coef_cp[0]-1)*diff(Y_coef_cp[1],'chi',1)
    )/B_alpha_coef[0]

    Coef_dchi_dchi_Y_raw_a = -(1-Delta_coef_cp[0])*iota_coef[0]**2*diff(Y_coef_cp[1],'chi',1)/B_alpha_coef[0]
    Coef_dchi_dchi_Y_raw_b = -(
        (2*Delta_coef_cp[0]-2)*iota_coef[0]*X_coef_cp[1]*dl_p*tau_p
        +iota_coef[0]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)
    )/B_alpha_coef[0]

    Coef_dchi_dchi_dphi_Y_raw = -(2*Delta_coef_cp[0]-2)*iota_coef[0]*Y_coef_cp[1]/B_alpha_coef[0]

    Coef_dphi_dphi_dchi_Y_raw = -(Delta_coef_cp[0]-1)*Y_coef_cp[1]/B_alpha_coef[0]

    Coef_dchi_dchi_dchi_Y_raw = -(Delta_coef_cp[0]-1)*iota_coef[0]**2*Y_coef_cp[1]/B_alpha_coef[0]

    Coef_B_theta = -(
        2*B_denom_coef_c[0]**2*(diff(p_perp_coef_cp[1],'phi',1))
        +2*B_denom_coef_c[0]**2*iota_coef[0]*(diff(p_perp_coef_cp[1],'chi',1))
        +(Delta_coef_cp[0]-2)*iota_coef[0]*(diff(B_denom_coef_c[1],'chi',1))
        +4*B_denom_coef_c[0]*B_denom_coef_c[1]*(diff(p_perp_coef_cp[0],'phi',1))
        +2*B_denom_coef_c[1]*(diff(Delta_coef_cp[0],'phi',1))
    )/2
    Coef_dchi_B_theta = B_denom_coef_c[0]*iota_coef[0]*Delta_coef_cp[1]
    Coef_dphi_B_theta = B_denom_coef_c[0]*Delta_coef_cp[1]

    # Coeff of B_psi ---------------------------------------------------------------
    # Evaluates coefficient of diff(B_psi_dummy,phi,j)
    # Separates n-indep and n-dep parts.

    const_D = (1-Delta_coef_cp[0])
    const_Dn = -const_D
    const_DD = 2*const_D
    const_DDn = -const_DD

    const_a = (const_Dn*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+const_D*Y_coef_cp[1]*(diff(X_coef_cp[1],'chi',1))**2)
    const_b = B_alpha_coef[0]*dl_p*kap_p
    const_bb = const_b*kap_p
    const_bbb = const_b*kap_p**2

    # cancels but the cancellation is noisy. We omit the calculation here.
    # const_c = (
    #     ((const_DD*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+const_DD*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2))*diff(Y_coef_cp[1],'phi',1)+const_DDn*iota_coef[0]*X_coef_cp[1]*Y_coef_cp[1]*diff(Y_coef_cp[1],'chi',3)+const_DDn*X_coef_cp[1]*Y_coef_cp[1]*diff(Y_coef_cp[1],'chi',2,'phi',1)+(const_DDn*iota_coef[0]*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1)+const_DDn*Y_coef_cp[1]*diff(X_coef_cp[1],'phi',1)+const_DDn*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',2)+const_DDn*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',1)+const_DDn*diff(X_coef_cp[1],'phi',1)*(diff(Y_coef_cp[1],'chi',1))**2+((4-4*Delta_coef_cp[0])*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+const_DD*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(Y_coef_cp[1],'chi',1)+const_DD*iota_coef[0]*Y_coef_cp[1]**2*diff(X_coef_cp[1],'chi',3)+const_DD*Y_coef_cp[1]**2*diff(X_coef_cp[1],'chi',2,'phi',1))*dl_p*kap_p**2*diff(tau_p,'phi',1)
    #     +(((const_DDn*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+const_DDn*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2))*diff(Y_coef_cp[1],'phi',1)+const_DD*iota_coef[0]*X_coef_cp[1]*Y_coef_cp[1]*diff(Y_coef_cp[1],'chi',3)+const_DD*X_coef_cp[1]*Y_coef_cp[1]*diff(Y_coef_cp[1],'chi',2,'phi',1)+(const_DD*iota_coef[0]*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1)+const_DD*Y_coef_cp[1]*diff(X_coef_cp[1],'phi',1)+const_DD*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',2)+const_DD*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',1)+const_DD*diff(X_coef_cp[1],'phi',1)*(diff(Y_coef_cp[1],'chi',1))**2+((4*Delta_coef_cp[0]-4)*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+const_DDn*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(Y_coef_cp[1],'chi',1)+const_DDn*iota_coef[0]*Y_coef_cp[1]**2*diff(X_coef_cp[1],'chi',3)+const_DDn*Y_coef_cp[1]**2*diff(X_coef_cp[1],'chi',2,'phi',1))*dl_p*kap_p*diff(kap_p,'phi',1)+((const_DD*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+const_DD*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2))*diff(Y_coef_cp[1],'phi',2)+const_DD*diff(X_coef_cp[1],'chi',2)*(diff(Y_coef_cp[1],'phi',1))**2+(const_DDn*iota_coef[0]*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',3)+const_DDn*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',2,'phi',1)+const_DDn*diff(X_coef_cp[1],'phi',1)*diff(Y_coef_cp[1],'chi',2)+const_DD*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',1)+((8-8*Delta_coef_cp[0])*iota_coef[0]*diff(X_coef_cp[1],'chi',2)+(4-4*Delta_coef_cp[0])*diff(X_coef_cp[1],'chi',1,'phi',1)-2*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1)+(6-6*Delta_coef_cp[0])*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+(6-6*Delta_coef_cp[0])*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)-2*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',2))*diff(Y_coef_cp[1],'phi',1)+const_DDn*iota_coef[0]**2*X_coef_cp[1]*Y_coef_cp[1]*diff(Y_coef_cp[1],'chi',4)+(4*Delta_coef_cp[0]-4)*iota_coef[0]*X_coef_cp[1]*Y_coef_cp[1]*diff(Y_coef_cp[1],'chi',3,'phi',1)+((4*Delta_coef_cp[0]-4)*iota_coef[0]**2*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1)+(4*Delta_coef_cp[0]-4)*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'phi',1)+(4*Delta_coef_cp[0]-4)*iota_coef[0]**2*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)+2*iota_coef[0]*X_coef_cp[1]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'chi',3)+const_DDn*X_coef_cp[1]*Y_coef_cp[1]*diff(Y_coef_cp[1],'chi',2,'phi',2)+((6*Delta_coef_cp[0]-6)*iota_coef[0]*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1)+(4*Delta_coef_cp[0]-4)*Y_coef_cp[1]*diff(X_coef_cp[1],'phi',1)+(4*Delta_coef_cp[0]-4)*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)+2*X_coef_cp[1]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'chi',2,'phi',1)+const_DDn*iota_coef[0]**2*X_coef_cp[1]*(diff(Y_coef_cp[1],'chi',2))**2+((4*Delta_coef_cp[0]-4)*iota_coef[0]*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1,'phi',1)+((8*Delta_coef_cp[0]-8)*iota_coef[0]*diff(X_coef_cp[1],'phi',1)+(4*Delta_coef_cp[0]-4)*iota_coef[0]**2*diff(X_coef_cp[1],'chi',1)+2*iota_coef[0]*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'chi',1)+const_DDn*Y_coef_cp[1]*diff(X_coef_cp[1],'phi',2)+2*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'phi',1)+const_DD*iota_coef[0]**2*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+const_DDn*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1)+2*iota_coef[0]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',2)+const_DDn*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',2)+const_DDn*X_coef_cp[1]*(diff(Y_coef_cp[1],'chi',1,'phi',1))**2+(((6*Delta_coef_cp[0]-6)*diff(X_coef_cp[1],'phi',1)+2*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'chi',1)+(6-6*Delta_coef_cp[0])*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+const_DD*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(Y_coef_cp[1],'chi',1,'phi',1)+(const_DDn*diff(X_coef_cp[1],'phi',2)+2*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'phi',1)+(4-4*Delta_coef_cp[0])*iota_coef[0]**2*diff(X_coef_cp[1],'chi',2))*(diff(Y_coef_cp[1],'chi',1))**2+((8-8*Delta_coef_cp[0])*iota_coef[0]**2*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+(10-10*Delta_coef_cp[0])*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)-4*iota_coef[0]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',2)+const_DD*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',2)-2*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(Y_coef_cp[1],'chi',1)+const_DD*iota_coef[0]**2*Y_coef_cp[1]**2*diff(X_coef_cp[1],'chi',4)+(4-4*Delta_coef_cp[0])*iota_coef[0]*Y_coef_cp[1]**2*diff(X_coef_cp[1],'chi',3,'phi',1)-2*iota_coef[0]*Y_coef_cp[1]**2*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',3)+const_DD*Y_coef_cp[1]**2*diff(X_coef_cp[1],'chi',2,'phi',2)-2*Y_coef_cp[1]**2*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',2,'phi',1))*dl_p*kap_p**2)*tau_p
    #     +((const_D*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+const_D*(diff(X_coef_cp[1],'chi',1))**2)*diff(Y_coef_cp[1],'phi',1)+const_Dn*iota_coef[0]*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',3)+const_Dn*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',2,'phi',1)+(const_Dn*X_coef_cp[1]*diff(X_coef_cp[1],'phi',1)+const_DDn*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',2)+const_Dn*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',1)+(const_Dn*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+const_D*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2))*diff(Y_coef_cp[1],'chi',1)+const_D*iota_coef[0]*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+const_D*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)+const_D*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2)+const_D*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*kap_p*diff(kap_p,'phi',2)
    #     +((const_DDn*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+const_DDn*(diff(X_coef_cp[1],'chi',1))**2)*diff(Y_coef_cp[1],'phi',1)+const_DD*iota_coef[0]*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',3)+const_DD*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',2,'phi',1)+(const_DD*X_coef_cp[1]*diff(X_coef_cp[1],'phi',1)+(4-4*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',2)+const_DD*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',1)+(const_DD*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+const_DDn*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2))*diff(Y_coef_cp[1],'chi',1)+const_DDn*iota_coef[0]*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+const_DDn*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)+const_DDn*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2)+const_DDn*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*(diff(kap_p,'phi',1))**2
    #     +((const_DD*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',2)+const_DD*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+const_DDn*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+const_DDn*Y_coef_cp[1]*(diff(X_coef_cp[1],'chi',1))**2)*dl_p**2*kap_p**3+((const_DD*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+const_DD*(diff(X_coef_cp[1],'chi',1))**2)*diff(Y_coef_cp[1],'phi',2)+((4-4*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+(4-4*Delta_coef_cp[0])*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)+((4-4*Delta_coef_cp[0])*iota_coef[0]*diff(X_coef_cp[1],'chi',1)-X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',2)+(4-4*Delta_coef_cp[0])*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1)-diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',1))**2)*diff(Y_coef_cp[1],'phi',1)+const_DDn*iota_coef[0]**2*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',4)+(4*Delta_coef_cp[0]-4)*iota_coef[0]*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',3,'phi',1)+((4*Delta_coef_cp[0]-4)*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'phi',1)+(6*Delta_coef_cp[0]-6)*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)+iota_coef[0]*X_coef_cp[1]**2*diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'chi',3)+const_DDn*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',2,'phi',2)+((4*Delta_coef_cp[0]-4)*X_coef_cp[1]*diff(X_coef_cp[1],'phi',1)+(8*Delta_coef_cp[0]-8)*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)+X_coef_cp[1]**2*diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'chi',2,'phi',1)+(const_DDn*X_coef_cp[1]*diff(X_coef_cp[1],'phi',2)+((4*Delta_coef_cp[0]-4)*iota_coef[0]*diff(X_coef_cp[1],'chi',1)+X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'phi',1)+(4*Delta_coef_cp[0]-4)*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1)+const_DDn*iota_coef[0]**2*(diff(X_coef_cp[1],'chi',1))**2+2*iota_coef[0]*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',2)+const_DDn*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',2)+((4*Delta_coef_cp[0]-4)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+(4-4*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1,'phi',1)+(const_DDn*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',2)+diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+(4-4*Delta_coef_cp[0])*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+(4-4*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)+(const_DD*iota_coef[0]**2*diff(X_coef_cp[1],'chi',1)-iota_coef[0]*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',2))*diff(Y_coef_cp[1],'chi',1)+const_DD*iota_coef[0]**2*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',4)+(4-4*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',3,'phi',1)+(const_DD*iota_coef[0]**2*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)-iota_coef[0]*X_coef_cp[1]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',3)+const_DD*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',2)+((4-4*Delta_coef_cp[0])*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)-X_coef_cp[1]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',2,'phi',1)-iota_coef[0]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2)+const_DD*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',2)-Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*kap_p)*diff(kap_p,'phi',1)
    #     +((const_DDn*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+const_DDn*(diff(X_coef_cp[1],'chi',1))**2)*diff(Y_coef_cp[1],'phi',1)+const_DD*iota_coef[0]*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',3)+const_DD*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',2,'phi',1)+((4-4*Delta_coef_cp[0])*X_coef_cp[1]*diff(X_coef_cp[1],'phi',1)+(6-6*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)-2*X_coef_cp[1]**2*diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'chi',2)+const_DD*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',1)+(const_DD*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+const_DD*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1)-2*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1)+const_DDn*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)*diff(X_coef_cp[1],'phi',1)+const_DDn*iota_coef[0]*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+const_DDn*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)+((6*Delta_coef_cp[0]-6)*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)+2*X_coef_cp[1]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',2)+(4*Delta_coef_cp[0]-4)*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1)+2*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',1))**2)*dl_p**2*kap_p**4
    #     +(2*B_alpha_coef[0]*B_denom_coef_c[0]*iota_coef[0]*diff(Delta_coef_cp[1],'chi',2)+2*B_alpha_coef[0]*B_denom_coef_c[0]*diff(Delta_coef_cp[1],'chi',1,'phi',1)+(2*B_alpha_coef[0]-2*B_alpha_coef[0]*Delta_coef_cp[0])*iota_coef[0]*diff(B_denom_coef_c[1],'chi',2)+(B_alpha_coef[0]*diff(Delta_coef_cp[0],'phi',2)-4*B_alpha_coef[0]*diff(Delta_coef_cp[0],'phi',1))*diff(B_denom_coef_c[1],'chi',1))*dl_p*kap_p**3
    #     +((const_Dn*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+const_Dn*(diff(X_coef_cp[1],'chi',1))**2)*diff(Y_coef_cp[1],'phi',3)+((3*Delta_coef_cp[0]-3)*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+(3*Delta_coef_cp[0]-3)*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)+((3*Delta_coef_cp[0]-3)*iota_coef[0]*diff(X_coef_cp[1],'chi',1)+X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',2)+(3*Delta_coef_cp[0]-3)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1)+diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',1))**2)*diff(Y_coef_cp[1],'phi',2)+(const_D*diff(X_coef_cp[1],'chi',2)*diff(X_coef_cp[1],'phi',2)-diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',2)*diff(X_coef_cp[1],'phi',1)+(3*Delta_coef_cp[0]-3)*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'chi',4)+(6*Delta_coef_cp[0]-6)*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',3,'phi',1)+(const_DDn*iota_coef[0]**2*diff(X_coef_cp[1],'chi',1)+2*iota_coef[0]*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',3)+(3*Delta_coef_cp[0]-3)*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',2)+((4*Delta_coef_cp[0]-4)*iota_coef[0]*diff(X_coef_cp[1],'chi',1)+2*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',2,'phi',1)+const_D*iota_coef[0]**2*(diff(X_coef_cp[1],'chi',2))**2+const_DD*iota_coef[0]*diff(X_coef_cp[1],'chi',1,'phi',1)*diff(X_coef_cp[1],'chi',2)+const_DDn*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',2)+diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(Y_coef_cp[1],'phi',1)+const_D*iota_coef[0]**3*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',5)+(3-3*Delta_coef_cp[0])*iota_coef[0]**2*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',4,'phi',1)+((3-3*Delta_coef_cp[0])*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'phi',1)+(4-4*Delta_coef_cp[0])*iota_coef[0]**3*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)-iota_coef[0]**2*X_coef_cp[1]**2*diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'chi',4)+(3-3*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',3,'phi',2)+((6-6*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'phi',1)+(9-9*Delta_coef_cp[0])*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)-2*iota_coef[0]*X_coef_cp[1]**2*diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'chi',3,'phi',1)+(const_DD*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'phi',2)+((3-3*Delta_coef_cp[0])*iota_coef[0]**2*diff(X_coef_cp[1],'chi',1)-iota_coef[0]*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'phi',1)+const_D*iota_coef[0]**3*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+(4-4*Delta_coef_cp[0])*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1)+const_DD*iota_coef[0]**3*(diff(X_coef_cp[1],'chi',1))**2-2*iota_coef[0]**2*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',3)+const_D*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',2,'phi',3)+((3-3*Delta_coef_cp[0])*X_coef_cp[1]*diff(X_coef_cp[1],'phi',1)+(6-6*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)-X_coef_cp[1]**2*diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'chi',2,'phi',2)+(const_DD*X_coef_cp[1]*diff(X_coef_cp[1],'phi',2)+((6-6*Delta_coef_cp[0])*iota_coef[0]*diff(X_coef_cp[1],'chi',1)-X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'phi',1)+const_Dn*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+(4-4*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1)+(3-3*Delta_coef_cp[0])*iota_coef[0]**2*(diff(X_coef_cp[1],'chi',1))**2-3*iota_coef[0]*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',2,'phi',1)+(const_D*X_coef_cp[1]*diff(X_coef_cp[1],'phi',3)+(const_Dn*diff(X_coef_cp[1],'phi',1)+const_DD*iota_coef[0]*diff(X_coef_cp[1],'chi',1)-X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'phi',2)+diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'phi',1))**2+(const_Dn*iota_coef[0]**2*diff(X_coef_cp[1],'chi',2)+const_DDn*iota_coef[0]*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(X_coef_cp[1],'phi',1)+(3*Delta_coef_cp[0]-3)*iota_coef[0]**3*X_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+const_DDn*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)+(const_Dn*iota_coef[0]**3*diff(X_coef_cp[1],'chi',1)+iota_coef[0]**2*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',2)+const_DD*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',2)+(const_D*iota_coef[0]**2*diff(X_coef_cp[1],'chi',1)-iota_coef[0]*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(Y_coef_cp[1],'chi',2)+const_D*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',3)+((3-3*Delta_coef_cp[0])*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+(3*Delta_coef_cp[0]-3)*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)-X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1,'phi',2)+((3-3*Delta_coef_cp[0])*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',2)-2*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+(7*Delta_coef_cp[0]-7)*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+(8*Delta_coef_cp[0]-8)*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)+((3*Delta_coef_cp[0]-3)*iota_coef[0]**2*diff(X_coef_cp[1],'chi',1)+3*iota_coef[0]*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',2)+const_Dn*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',2)+X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(Y_coef_cp[1],'chi',1,'phi',1)+(const_D*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',3)+(const_D*iota_coef[0]*diff(X_coef_cp[1],'chi',2)-diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(X_coef_cp[1],'phi',2)+(const_Dn*iota_coef[0]**2*diff(X_coef_cp[1],'chi',3)+const_DDn*iota_coef[0]*diff(X_coef_cp[1],'chi',2,'phi',1)+const_Dn*diff(X_coef_cp[1],'chi',1,'phi',2)+diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(X_coef_cp[1],'phi',1)+(3*Delta_coef_cp[0]-3)*iota_coef[0]**3*X_coef_cp[1]*diff(X_coef_cp[1],'chi',4)+(6*Delta_coef_cp[0]-6)*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'chi',3,'phi',1)+(const_DDn*iota_coef[0]**3*diff(X_coef_cp[1],'chi',1)+2*iota_coef[0]**2*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',3)+(3*Delta_coef_cp[0]-3)*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',2)+((3*Delta_coef_cp[0]-3)*iota_coef[0]**2*diff(X_coef_cp[1],'chi',1)+2*iota_coef[0]*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',2,'phi',1)+const_D*iota_coef[0]**3*(diff(X_coef_cp[1],'chi',2))**2+const_DD*iota_coef[0]**2*diff(X_coef_cp[1],'chi',1,'phi',1)*diff(X_coef_cp[1],'chi',2))*diff(Y_coef_cp[1],'chi',1)+(const_D*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+const_D*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1))*diff(X_coef_cp[1],'phi',2)+((-iota_coef[0]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',3))-Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',2,'phi',1))*diff(X_coef_cp[1],'phi',1)+const_Dn*iota_coef[0]**3*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',5)+(3*Delta_coef_cp[0]-3)*iota_coef[0]**2*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',4,'phi',1)+(const_Dn*iota_coef[0]**3*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)+iota_coef[0]**2*X_coef_cp[1]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',4)+(3*Delta_coef_cp[0]-3)*iota_coef[0]*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',3,'phi',2)+((3*Delta_coef_cp[0]-3)*iota_coef[0]**2*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)+2*iota_coef[0]*X_coef_cp[1]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',3,'phi',1)+(const_DD*iota_coef[0]**3*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+(3-3*Delta_coef_cp[0])*iota_coef[0]**2*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(X_coef_cp[1],'chi',3)+const_Dn*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',3)+((3*Delta_coef_cp[0]-3)*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)+X_coef_cp[1]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',2,'phi',2)+((3-3*Delta_coef_cp[0])*iota_coef[0]**2*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+(4-4*Delta_coef_cp[0])*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1)+iota_coef[0]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(X_coef_cp[1],'chi',2,'phi',1)-iota_coef[0]**2*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',2))**2+(const_D*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',2)-2*iota_coef[0]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(X_coef_cp[1],'chi',2)+const_Dn*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',3)+(const_D*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1)+Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(X_coef_cp[1],'chi',1,'phi',2)-Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',1,'phi',1))**2)*kap_p**2
    # )
    # const_d = (
    #     const_DDn*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'phi',1)
    #     +const_DD*iota_coef[0]*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',2)
    #     +const_DD*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',1)
    #     +const_DD*diff(X_coef_cp[1],'phi',1)*(diff(Y_coef_cp[1],'chi',1))**2
    #     +(const_DDn*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)
    #     +const_DDn*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(Y_coef_cp[1],'chi',1)
    # )*dl_p*kap_p**2*diff(tau_p,'phi',1)

    # const_e = (
    #     (
    #         const_DD*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'phi',1)
    #         +const_DDn*iota_coef[0]*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',2)+const_DDn*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',1)+const_DDn*diff(X_coef_cp[1],'phi',1)*(diff(Y_coef_cp[1],'chi',1))**2+(const_DD*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+const_DD*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(Y_coef_cp[1],'chi',1)
    #     )*dl_p*kap_p*diff(kap_p,'phi',1)
    #     +(
    #         const_DDn*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'phi',2)
    #         +(
    #             const_DDn*iota_coef[0]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',2)
    #             +const_DDn*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',1)
    #             +(
    #                 (4*Delta_coef_cp[0]-4)*iota_coef[0]*diff(X_coef_cp[1],'chi',2)
    #                 +(4*Delta_coef_cp[0]-4)*diff(X_coef_cp[1],'chi',1,'phi',1)
    #                 +2*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)
    #             )*diff(Y_coef_cp[1],'chi',1)
    #         )*diff(Y_coef_cp[1],'phi',1)
    #         +const_DD*iota_coef[0]**2*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',3)
    #         +(4-4*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',2,'phi',1)
    #         +const_DD*iota_coef[0]**2*X_coef_cp[1]*(diff(Y_coef_cp[1],'chi',2))**2
    #         +(
    #             (4-4*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1,'phi',1)
    #             +(
    #                 (6-6*Delta_coef_cp[0])*iota_coef[0]*diff(X_coef_cp[1],'phi',1)
    #                 +const_DD*iota_coef[0]**2*diff(X_coef_cp[1],'chi',1)
    #                 -2*iota_coef[0]*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)
    #             )*diff(Y_coef_cp[1],'chi',1)
    #             +const_DDn*iota_coef[0]**2*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)
    #             +const_DDn*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1)
    #         )*diff(Y_coef_cp[1],'chi',2)
    #         +const_DD*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',2)
    #         +const_DD*X_coef_cp[1]*(diff(Y_coef_cp[1],'chi',1,'phi',1))**2
    #         +(
    #             (
    #                 (6-6*Delta_coef_cp[0])*diff(X_coef_cp[1],'phi',1)
    #                 -2*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)
    #             )*diff(Y_coef_cp[1],'chi',1)
    #             +const_DDn*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)
    #             +const_DDn*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(Y_coef_cp[1],'chi',1,'phi',1)
    #             +(
    #                 const_DD*diff(X_coef_cp[1],'phi',2)
    #                 -2*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'phi',1)
    #                 +const_DDn*iota_coef[0]**2*diff(X_coef_cp[1],'chi',2)
    #             )*(diff(Y_coef_cp[1],'chi',1))**2
    #             +(
    #                 const_DDn*iota_coef[0]**2*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',3)
    #                 +(4*Delta_coef_cp[0]-4)*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)
    #                 +2*iota_coef[0]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',2)
    #                 +const_DDn*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',2)
    #                 +2*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1,'phi',1)
    #             )*diff(Y_coef_cp[1],'chi',1)
    #     )*dl_p*kap_p**2
    # )*tau_p

    # const_f = ((const_Dn*(diff(X_coef_cp[1],'chi',1))**2*diff(Y_coef_cp[1],'phi',1)+const_D*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',2)+const_D*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',1)+const_D*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)*diff(Y_coef_cp[1],'chi',1)+const_Dn*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2)+const_Dn*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*kap_p*diff(kap_p,'phi',2)+(const_DD*(diff(X_coef_cp[1],'chi',1))**2*diff(Y_coef_cp[1],'phi',1)+const_DDn*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',2)+const_DDn*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',1)+const_DDn*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)*diff(Y_coef_cp[1],'chi',1)+const_DD*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2)+const_DD*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*(diff(kap_p,'phi',1))**2+((const_DDn*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+const_DD*Y_coef_cp[1]*(diff(X_coef_cp[1],'chi',1))**2)*dl_p**2*kap_p**3+(const_DDn*(diff(X_coef_cp[1],'chi',1))**2*diff(Y_coef_cp[1],'phi',2)+((4*Delta_coef_cp[0]-4)*iota_coef[0]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2)+(4*Delta_coef_cp[0]-4)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1)+diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',1))**2)*diff(Y_coef_cp[1],'phi',1)+const_DD*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',3)+(4-4*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',2,'phi',1)+((4-4*Delta_coef_cp[0])*iota_coef[0]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+const_DD*iota_coef[0]**2*(diff(X_coef_cp[1],'chi',1))**2-iota_coef[0]*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',2)+const_DD*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',2)+((4-4*Delta_coef_cp[0])*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)-X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1,'phi',1)+(const_DD*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',2)-diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+const_DDn*iota_coef[0]**2*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2))*diff(Y_coef_cp[1],'chi',1)+const_DDn*iota_coef[0]**2*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',3)+(4*Delta_coef_cp[0]-4)*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2,'phi',1)+iota_coef[0]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2)+const_DDn*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',2)+Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*kap_p)*diff(kap_p,'phi',1)+(const_DD*(diff(X_coef_cp[1],'chi',1))**2*diff(Y_coef_cp[1],'phi',1)+const_DDn*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',2)+const_DDn*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',1)+(const_DDn*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+const_DDn*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+const_DDn*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1)+2*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1)+(4-4*Delta_coef_cp[0])*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2)+(4-4*Delta_coef_cp[0])*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1)-2*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',1))**2)*dl_p**2*kap_p**4+((-2*B_alpha_coef[0]*B_denom_coef_c[0]*iota_coef[0]*diff(Delta_coef_cp[1],'chi',2))-2*B_alpha_coef[0]*B_denom_coef_c[0]*diff(Delta_coef_cp[1],'chi',1,'phi',1)+(2*B_alpha_coef[0]*Delta_coef_cp[0]-2*B_alpha_coef[0])*iota_coef[0]*diff(B_denom_coef_c[1],'chi',2)+(4*B_alpha_coef[0]*diff(Delta_coef_cp[0],'phi',1)-B_alpha_coef[0]*diff(Delta_coef_cp[0],'phi',2))*diff(B_denom_coef_c[1],'chi',1))*dl_p*kap_p**3+(const_D*(diff(X_coef_cp[1],'chi',1))**2*diff(Y_coef_cp[1],'phi',3)+((3-3*Delta_coef_cp[0])*iota_coef[0]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2)+(3-3*Delta_coef_cp[0])*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1)-diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',1))**2)*diff(Y_coef_cp[1],'phi',2)+(const_DD*iota_coef[0]**2*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',3)+(4-4*Delta_coef_cp[0])*iota_coef[0]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2,'phi',1)-iota_coef[0]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2)+const_DD*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',2)-diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(Y_coef_cp[1],'phi',1)+const_Dn*iota_coef[0]**3*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',4)+(3*Delta_coef_cp[0]-3)*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',3,'phi',1)+((3*Delta_coef_cp[0]-3)*iota_coef[0]**2*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+const_DDn*iota_coef[0]**3*(diff(X_coef_cp[1],'chi',1))**2+iota_coef[0]**2*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',3)+(3*Delta_coef_cp[0]-3)*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',2,'phi',2)+((6*Delta_coef_cp[0]-6)*iota_coef[0]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+(3*Delta_coef_cp[0]-3)*iota_coef[0]**2*(diff(X_coef_cp[1],'chi',1))**2+2*iota_coef[0]*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',2,'phi',1)+((3*Delta_coef_cp[0]-3)*iota_coef[0]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',2)+2*iota_coef[0]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+const_D*iota_coef[0]**3*X_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+const_DD*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)-iota_coef[0]**2*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',2)+const_D*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',2)+((3*Delta_coef_cp[0]-3)*iota_coef[0]**2*diff(X_coef_cp[1],'chi',1)-iota_coef[0]*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',1,'phi',1)+iota_coef[0]**2*diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',1))**2)*diff(Y_coef_cp[1],'chi',2)+const_Dn*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',3)+((3*Delta_coef_cp[0]-3)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1,'phi',2)+((3*Delta_coef_cp[0]-3)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',2)+2*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+const_D*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+const_DD*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)+((3-3*Delta_coef_cp[0])*iota_coef[0]**2*diff(X_coef_cp[1],'chi',1)-iota_coef[0]*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',2)+const_D*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',2)-X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(Y_coef_cp[1],'chi',1,'phi',1)+(const_Dn*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',3)+diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',2)+(const_D*iota_coef[0]**2*diff(X_coef_cp[1],'chi',3)+const_DD*iota_coef[0]*diff(X_coef_cp[1],'chi',2,'phi',1)-iota_coef[0]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',2)+const_D*diff(X_coef_cp[1],'chi',1,'phi',2)-diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(X_coef_cp[1],'phi',1)+const_DD*iota_coef[0]**3*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',3)+(3-3*Delta_coef_cp[0])*iota_coef[0]**2*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2,'phi',1)-iota_coef[0]**2*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2))*diff(Y_coef_cp[1],'chi',1)+const_D*iota_coef[0]**3*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',4)+(3-3*Delta_coef_cp[0])*iota_coef[0]**2*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',3,'phi',1)+(const_Dn*iota_coef[0]**3*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+const_Dn*iota_coef[0]**2*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1)-iota_coef[0]**2*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(X_coef_cp[1],'chi',3)+(3-3*Delta_coef_cp[0])*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2,'phi',2)+(const_DDn*iota_coef[0]**2*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+const_DDn*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1)-2*iota_coef[0]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(X_coef_cp[1],'chi',2,'phi',1)+iota_coef[0]**2*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',2))**2+(const_Dn*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',2)+2*iota_coef[0]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(X_coef_cp[1],'chi',2)+const_D*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',3)+(const_Dn*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1)-Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(X_coef_cp[1],'chi',1,'phi',2)+Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',1,'phi',1))**2)*kap_p**2)

    const_g = -((const_DD*X_coef_cp[1]*Y_coef_cp[1]*diff(Y_coef_cp[1],'chi',2)+const_DD*X_coef_cp[1]*(diff(Y_coef_cp[1],'chi',1))**2+const_DDn*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+const_DDn*Y_coef_cp[1]**2*diff(X_coef_cp[1],'chi',2))*dl_p*kap_p**2*diff(tau_p,'phi',1)+((const_DDn*X_coef_cp[1]*Y_coef_cp[1]*diff(Y_coef_cp[1],'chi',2)+const_DDn*X_coef_cp[1]*(diff(Y_coef_cp[1],'chi',1))**2+const_DD*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+const_DD*Y_coef_cp[1]**2*diff(X_coef_cp[1],'chi',2))*dl_p*kap_p*diff(kap_p,'phi',1)+((const_DD*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',2)+(4*Delta_coef_cp[0]-4)*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+(6*Delta_coef_cp[0]-6)*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2))*diff(Y_coef_cp[1],'phi',1)+(4-4*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*Y_coef_cp[1]*diff(Y_coef_cp[1],'chi',3)+(4-4*Delta_coef_cp[0])*X_coef_cp[1]*Y_coef_cp[1]*diff(Y_coef_cp[1],'chi',2,'phi',1)+((8-8*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1)+(4-4*Delta_coef_cp[0])*Y_coef_cp[1]*diff(X_coef_cp[1],'phi',1)+const_DD*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)-2*X_coef_cp[1]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'chi',2)+((6-6*Delta_coef_cp[0])*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1)+const_DDn*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1,'phi',1)+((4-4*Delta_coef_cp[0])*diff(X_coef_cp[1],'phi',1)-2*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*(diff(Y_coef_cp[1],'chi',1))**2+((10*Delta_coef_cp[0]-10)*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+(4*Delta_coef_cp[0]-4)*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1)+2*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1)+(4*Delta_coef_cp[0]-4)*iota_coef[0]*Y_coef_cp[1]**2*diff(X_coef_cp[1],'chi',3)+(4*Delta_coef_cp[0]-4)*Y_coef_cp[1]**2*diff(X_coef_cp[1],'chi',2,'phi',1)+2*Y_coef_cp[1]**2*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',2))*dl_p*kap_p**2)*tau_p+(const_D*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',2)+const_D*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+const_Dn*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+const_Dn*Y_coef_cp[1]*(diff(X_coef_cp[1],'chi',1))**2)*kap_p*diff(kap_p,'phi',2)+(const_DDn*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',2)+const_DDn*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+const_DD*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+const_DD*Y_coef_cp[1]*(diff(X_coef_cp[1],'chi',1))**2)*(diff(kap_p,'phi',1))**2+(((4*Delta_coef_cp[0]-4)*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+(4*Delta_coef_cp[0]-4)*(diff(X_coef_cp[1],'chi',1))**2)*diff(Y_coef_cp[1],'phi',1)+(4-4*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',3)+(4-4*Delta_coef_cp[0])*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',2,'phi',1)+((4-4*Delta_coef_cp[0])*X_coef_cp[1]*diff(X_coef_cp[1],'phi',1)+(8-8*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)-X_coef_cp[1]**2*diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'chi',2)+(4-4*Delta_coef_cp[0])*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',1)+((4-4*Delta_coef_cp[0])*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+(4*Delta_coef_cp[0]-4)*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)-X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1)+(4*Delta_coef_cp[0]-4)*iota_coef[0]*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+(4*Delta_coef_cp[0]-4)*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)+((4*Delta_coef_cp[0]-4)*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)+X_coef_cp[1]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',2)+(4*Delta_coef_cp[0]-4)*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1)+Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',1))**2)*kap_p*diff(kap_p,'phi',1)+(const_DDn*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',2)+const_DDn*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+const_DD*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+const_DD*Y_coef_cp[1]*(diff(X_coef_cp[1],'chi',1))**2)*dl_p**2*kap_p**4+(((-2*B_alpha_coef[0]*diff(Delta_coef_cp[0],'phi',1))+4*B_alpha_coef[0]*Delta_coef_cp[0]-4*B_alpha_coef[0])*diff(B_denom_coef_c[1],'chi',1)-2*B_alpha_coef[0]*B_denom_coef_c[0]*diff(Delta_coef_cp[1],'chi',1))*dl_p*kap_p**3+(((3-3*Delta_coef_cp[0])*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+(3-3*Delta_coef_cp[0])*(diff(X_coef_cp[1],'chi',1))**2)*diff(Y_coef_cp[1],'phi',2)+((6-6*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+(6-6*Delta_coef_cp[0])*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)+((6-6*Delta_coef_cp[0])*iota_coef[0]*diff(X_coef_cp[1],'chi',1)-2*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',2)+(6-6*Delta_coef_cp[0])*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1)-2*diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',1))**2)*diff(Y_coef_cp[1],'phi',1)+(3*Delta_coef_cp[0]-3)*iota_coef[0]**2*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',4)+(6*Delta_coef_cp[0]-6)*iota_coef[0]*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',3,'phi',1)+((6*Delta_coef_cp[0]-6)*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'phi',1)+(9*Delta_coef_cp[0]-9)*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)+2*iota_coef[0]*X_coef_cp[1]**2*diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'chi',3)+(3*Delta_coef_cp[0]-3)*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',2,'phi',2)+((6*Delta_coef_cp[0]-6)*X_coef_cp[1]*diff(X_coef_cp[1],'phi',1)+(12*Delta_coef_cp[0]-12)*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)+2*X_coef_cp[1]**2*diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'chi',2,'phi',1)+(const_DDn*X_coef_cp[1]*diff(X_coef_cp[1],'phi',2)+((6*Delta_coef_cp[0]-6)*iota_coef[0]*diff(X_coef_cp[1],'chi',1)+X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'phi',1)+const_D*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+(4*Delta_coef_cp[0]-4)*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1)+(3*Delta_coef_cp[0]-3)*iota_coef[0]**2*(diff(X_coef_cp[1],'chi',1))**2+3*iota_coef[0]*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',2)+(3*Delta_coef_cp[0]-3)*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',2)+((6*Delta_coef_cp[0]-6)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+(6-6*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+2*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1,'phi',1)+((3*Delta_coef_cp[0]-3)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',2)+2*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+(7-7*Delta_coef_cp[0])*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+(8-8*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)+((3-3*Delta_coef_cp[0])*iota_coef[0]**2*diff(X_coef_cp[1],'chi',1)-3*iota_coef[0]*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',2)+const_D*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',2)-X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(Y_coef_cp[1],'chi',1)+const_Dn*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)*diff(X_coef_cp[1],'phi',2)+Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',2)*diff(X_coef_cp[1],'phi',1)+(3-3*Delta_coef_cp[0])*iota_coef[0]**2*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',4)+(6-6*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',3,'phi',1)+(const_DD*iota_coef[0]**2*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)-2*iota_coef[0]*X_coef_cp[1]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',3)+(3-3*Delta_coef_cp[0])*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',2)+((4-4*Delta_coef_cp[0])*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)-2*X_coef_cp[1]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',2,'phi',1)+const_Dn*iota_coef[0]**2*Y_coef_cp[1]*(diff(X_coef_cp[1],'chi',2))**2+const_DDn*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1)*diff(X_coef_cp[1],'chi',2)+const_DD*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',2)-Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*kap_p**2)

    const_h = (((-const_DDn*X_coef_cp[1]*(diff(Y_coef_cp[1],'chi',1))**2)-const_DD*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1))*dl_p*kap_p**2*diff(tau_p,'phi',1))

    const_i = (((-(const_DD*X_coef_cp[1]*(diff(Y_coef_cp[1],'chi',1))**2+const_DDn*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1))*dl_p*kap_p*diff(kap_p,'phi',1))-((4-4*Delta_coef_cp[0])*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'phi',1)+((6*Delta_coef_cp[0]-6)*iota_coef[0]*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1)+const_DD*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',2)+((6*Delta_coef_cp[0]-6)*X_coef_cp[1]*diff(Y_coef_cp[1],'chi',1)+const_DD*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1,'phi',1)+((4*Delta_coef_cp[0]-4)*diff(X_coef_cp[1],'phi',1)+2*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*(diff(Y_coef_cp[1],'chi',1))**2+((4-4*Delta_coef_cp[0])*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+(4-4*Delta_coef_cp[0])*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',1)-2*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1))*dl_p*kap_p**2)*tau_p)

    const_j = ((-const_a*kap_p*diff(kap_p,'phi',2))-(const_DD*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+const_DDn*Y_coef_cp[1]*(diff(X_coef_cp[1],'chi',1))**2)*(diff(kap_p,'phi',1))**2-((4-4*Delta_coef_cp[0])*(diff(X_coef_cp[1],'chi',1))**2*diff(Y_coef_cp[1],'phi',1)+(4*Delta_coef_cp[0]-4)*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',2)+(4*Delta_coef_cp[0]-4)*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',1)+((4*Delta_coef_cp[0]-4)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1)+(4-4*Delta_coef_cp[0])*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2)+(4-4*Delta_coef_cp[0])*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1)-Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',1))**2)*kap_p*diff(kap_p,'phi',1)-(const_DD*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+const_DDn*Y_coef_cp[1]*(diff(X_coef_cp[1],'chi',1))**2)*dl_p**2*kap_p**4-(2*B_alpha_coef[0]*B_denom_coef_c[0]*diff(Delta_coef_cp[1],'chi',1)+(2*B_alpha_coef[0]*diff(Delta_coef_cp[0],'phi',1)-4*B_alpha_coef[0]*Delta_coef_cp[0]+4*B_alpha_coef[0])*diff(B_denom_coef_c[1],'chi',1))*dl_p*kap_p**3-((3*Delta_coef_cp[0]-3)*(diff(X_coef_cp[1],'chi',1))**2*diff(Y_coef_cp[1],'phi',2)+((6*Delta_coef_cp[0]-6)*iota_coef[0]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2)+(6*Delta_coef_cp[0]-6)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1)+2*diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',1))**2)*diff(Y_coef_cp[1],'phi',1)+(3-3*Delta_coef_cp[0])*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',3)+(6-6*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',2,'phi',1)+((6-6*Delta_coef_cp[0])*iota_coef[0]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+(3-3*Delta_coef_cp[0])*iota_coef[0]**2*(diff(X_coef_cp[1],'chi',1))**2-2*iota_coef[0]*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',2)+(3-3*Delta_coef_cp[0])*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',2)+((6-6*Delta_coef_cp[0])*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)-2*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1,'phi',1)+((3-3*Delta_coef_cp[0])*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',2)-2*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+const_Dn*iota_coef[0]**2*X_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+const_DDn*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)+((3*Delta_coef_cp[0]-3)*iota_coef[0]**2*diff(X_coef_cp[1],'chi',1)+iota_coef[0]*X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',2)+const_Dn*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1,'phi',2)+X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*diff(Y_coef_cp[1],'chi',1)+const_DDn*iota_coef[0]**2*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',3)+(4*Delta_coef_cp[0]-4)*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2,'phi',1)+iota_coef[0]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2)+const_DDn*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',2)+Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1))*kap_p**2)

    const_k = -(
        (const_DD*X_coef_cp[1]*Y_coef_cp[1]*diff(Y_coef_cp[1],'chi',2)+const_DD*X_coef_cp[1]*(diff(Y_coef_cp[1],'chi',1))**2+const_DDn*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+const_DDn*Y_coef_cp[1]**2*diff(X_coef_cp[1],'chi',2))*dl_p*kap_p*tau_p
        +(const_DD*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',2)+const_DD*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+const_DDn*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+const_DDn*Y_coef_cp[1]*(diff(X_coef_cp[1],'chi',1))**2)*diff(kap_p,'phi',1)
        +(B_alpha_coef[0]-B_alpha_coef[0]*Delta_coef_cp[0])*diff(B_denom_coef_c[1],'chi',1)*dl_p*kap_p**2
        +(((3-3*Delta_coef_cp[0])*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+(3-3*Delta_coef_cp[0])*(diff(X_coef_cp[1],'chi',1))**2)*diff(Y_coef_cp[1],'phi',1)+(3*Delta_coef_cp[0]-3)*iota_coef[0]*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',3)+(3*Delta_coef_cp[0]-3)*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',2,'phi',1)+((3*Delta_coef_cp[0]-3)*X_coef_cp[1]*diff(X_coef_cp[1],'phi',1)+(6*Delta_coef_cp[0]-6)*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)+X_coef_cp[1]**2*diff(Delta_coef_cp[0],'phi',1))*diff(Y_coef_cp[1],'chi',2)+(3*Delta_coef_cp[0]-3)*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',1)+((3*Delta_coef_cp[0]-3)*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)+(3-3*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',2)+X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1)+(3-3*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',3)+(3-3*Delta_coef_cp[0])*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2,'phi',1)+((3-3*Delta_coef_cp[0])*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)-X_coef_cp[1]*Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1))*diff(X_coef_cp[1],'chi',2)+(3-3*Delta_coef_cp[0])*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1)-Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',1))**2)*kap_p
    )

    const_l = (((-const_DDn*X_coef_cp[1]*(diff(Y_coef_cp[1],'chi',1))**2)-const_DD*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1))*dl_p*kap_p*tau_p)

    const_m = ((-(const_DDn*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)+const_DD*Y_coef_cp[1]*(diff(X_coef_cp[1],'chi',1))**2)*diff(kap_p,'phi',1))-(B_alpha_coef[0]*Delta_coef_cp[0]-B_alpha_coef[0])*diff(B_denom_coef_c[1],'chi',1)*dl_p*kap_p**2-((3*Delta_coef_cp[0]-3)*(diff(X_coef_cp[1],'chi',1))**2*diff(Y_coef_cp[1],'phi',1)+(3-3*Delta_coef_cp[0])*iota_coef[0]*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',2)+(3-3*Delta_coef_cp[0])*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1,'phi',1)+((3-3*Delta_coef_cp[0])*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'phi',1)-X_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*diff(X_coef_cp[1],'chi',1))*diff(Y_coef_cp[1],'chi',1)+(3*Delta_coef_cp[0]-3)*iota_coef[0]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',2)+(3*Delta_coef_cp[0]-3)*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(X_coef_cp[1],'chi',1,'phi',1)+Y_coef_cp[1]*diff(Delta_coef_cp[0],'phi',1)*(diff(X_coef_cp[1],'chi',1))**2)*kap_p)

    const_n = (
        const_D*X_coef_cp[1]**2*diff(Y_coef_cp[1],'chi',2)
        +const_D*X_coef_cp[1]*diff(X_coef_cp[1],'chi',1)*diff(Y_coef_cp[1],'chi',1)
        +const_Dn*X_coef_cp[1]*Y_coef_cp[1]*diff(X_coef_cp[1],'chi',2)
        +const_Dn*Y_coef_cp[1]*(diff(X_coef_cp[1],'chi',1))**2
    )

    # cancels but the cancellation is noisy
    # const_0 = const_c/const_bbb
    # const_1 = (const_d+const_e+const_f)/const_bbb
    const_2 = const_g/const_bbb
    const_3 = (const_h+const_i+const_j)/const_bbb
    const_4 = const_k/const_bb
    const_5 = (const_l+const_m)/const_bb
    const_6 = const_a/const_b
    const_7 = const_n/const_b

    return({
        'Coef_Y_raw':Coef_Y_raw,
        'Coef_dchi_Y_raw_a':Coef_dchi_Y_raw_a,
        'Coef_dchi_Y_raw_b':Coef_dchi_Y_raw_b,
        'Coef_dchi_Y_raw_c':Coef_dchi_Y_raw_c,
        'Coef_dphi_Y_raw':Coef_dphi_Y_raw,
        'Coef_dchi_dphi_Y_raw_a':Coef_dchi_dphi_Y_raw_a,
        'Coef_dchi_dphi_Y_raw_b':Coef_dchi_dphi_Y_raw_b,
        'Coef_dphi_dphi_Y_raw':Coef_dphi_dphi_Y_raw,
        'Coef_dchi_dchi_Y_raw_a':Coef_dchi_dchi_Y_raw_a,
        'Coef_dchi_dchi_Y_raw_b':Coef_dchi_dchi_Y_raw_b,
        'Coef_dchi_dchi_dphi_Y_raw':Coef_dchi_dchi_dphi_Y_raw,
        'Coef_dphi_dphi_dchi_Y_raw':Coef_dphi_dphi_dchi_Y_raw,
        'Coef_dchi_dchi_dchi_Y_raw':Coef_dchi_dchi_dchi_Y_raw,
        'Coef_B_theta':Coef_B_theta,
        'Coef_dchi_B_theta':Coef_dchi_B_theta,
        'Coef_dphi_B_theta':Coef_dphi_B_theta,
        # 'const_0':const_0, # cancels but the cancellation is noisy
        # 'const_1':const_1,
        'const_2':const_2,
        'const_3':const_3,
        'const_4':const_4,
        'const_5':const_5,
        'const_6':const_6,
        'const_7':const_7
    })







def calculate_loop_coefficients(
    n, B_alpha_coef, B_denom_coef_c, iota_coef, dl_p, kap_p,
    raws
):

    Coef_Y_raw = raws['Coef_Y_raw']
    Coef_dchi_Y_raw_a = raws['Coef_dchi_Y_raw_a']
    Coef_dchi_Y_raw_b = raws['Coef_dchi_Y_raw_b']
    Coef_dchi_Y_raw_c = raws['Coef_dchi_Y_raw_c']
    Coef_dphi_Y_raw = raws['Coef_dphi_Y_raw']
    Coef_dchi_dphi_Y_raw_a = raws['Coef_dchi_dphi_Y_raw_a']
    Coef_dchi_dphi_Y_raw_b = raws['Coef_dchi_dphi_Y_raw_b']
    Coef_dphi_dphi_Y_raw = raws['Coef_dphi_dphi_Y_raw']
    Coef_dchi_dchi_Y_raw_a = raws['Coef_dchi_dchi_Y_raw_a']
    Coef_dchi_dchi_Y_raw_b = raws['Coef_dchi_dchi_Y_raw_b']
    Coef_dchi_dchi_dphi_Y_raw = raws['Coef_dchi_dchi_dphi_Y_raw']
    Coef_dphi_dphi_dchi_Y_raw = raws['Coef_dphi_dphi_dchi_Y_raw']
    Coef_dchi_dchi_dchi_Y_raw = raws['Coef_dchi_dchi_dchi_Y_raw']
    Coef_B_theta = raws['Coef_B_theta']
    Coef_dchi_B_theta = raws['Coef_dchi_B_theta']
    Coef_dphi_B_theta = raws['Coef_dphi_B_theta']
    # const_0 = raws['const_0']
    # const_1 = raws['const_1']
    const_2 = raws['const_2']
    const_3 = raws['const_3']
    const_4 = raws['const_4']
    const_5 = raws['const_5']
    const_6 = raws['const_6']
    const_7 = raws['const_7']

    # Coeff of Y -------------------------------------------------------------------
    Coef_Y = Coef_Y_raw*(n-1)/n
    Coef_dchi_Y = Coef_dchi_Y_raw_a/B_alpha_coef[0]*(n-2)/n + Coef_dchi_Y_raw_b/n + Coef_dchi_Y_raw_c
    Coef_dphi_Y = Coef_dphi_Y_raw*(n-1)/n
    Coef_dchi_dphi_Y = Coef_dchi_dphi_Y_raw_a*(n-1)/n + Coef_dchi_dphi_Y_raw_b/n
    Coef_dphi_dphi_Y = Coef_dphi_dphi_Y_raw*(n-1)/n
    Coef_dchi_dchi_Y = Coef_dchi_dchi_Y_raw_a*(n-1)/n + Coef_dchi_dchi_Y_raw_b/n
    Coef_dchi_dchi_dphi_Y = Coef_dchi_dchi_dphi_Y_raw/n
    Coef_dphi_dphi_dchi_Y = Coef_dphi_dphi_dchi_Y_raw/n
    Coef_dchi_dchi_dchi_Y = Coef_dchi_dchi_dchi_Y_raw/n

    # cancels but the cancellation is noisy
    # coef_B_psi_dphi_0 = const_0/n/(n-1)+const_1/(n-1)
    coef_B_psi_dphi_1 = const_2/n/(n-1)+const_3/(n-1)
    coef_B_psi_dphi_2 = const_4/n/(n-1)+const_5/(n-1)
    # Seem to have no real components
    coef_B_psi_dphi_3 = const_6/(n-1)+const_7/n/(n-1)
    coef_B_psi_dphi_3 = ChiPhiFuncGrid(1j*np.imag(coef_B_psi_dphi_3.content))

    return({
        'Coef_Y': Coef_Y,
        'Coef_dchi_Y': Coef_dchi_Y,
        'Coef_dphi_Y': Coef_dphi_Y,
        'Coef_dchi_dphi_Y': Coef_dchi_dphi_Y,
        'Coef_dphi_dphi_Y': Coef_dphi_dphi_Y,
        'Coef_dchi_dchi_Y': Coef_dchi_dchi_Y,
        'Coef_dchi_dchi_dphi_Y': Coef_dchi_dchi_dphi_Y,
        'Coef_dphi_dphi_dchi_Y': Coef_dphi_dphi_dchi_Y,
        'Coef_dchi_dchi_dchi_Y': Coef_dchi_dchi_dchi_Y,
        'Coef_B_theta': Coef_B_theta,
        'Coef_dchi_B_theta': Coef_dchi_B_theta,
        'Coef_dphi_B_theta': Coef_dphi_B_theta,
        'coef_B_psi_dphi_1': coef_B_psi_dphi_1,
        'coef_B_psi_dphi_2': coef_B_psi_dphi_2,
        'coef_B_psi_dphi_3': coef_B_psi_dphi_3
    })
